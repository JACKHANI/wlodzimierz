<div class="container">
  <div class="row pb-3">
    <div class="col-sm-3 min-vh-100 container-scroll overflow-auto">
      <app-users-conversations (conversationChanged)="onConversationChanged($event)"
                               [user]="user"></app-users-conversations>
    </div>
    <section *ngIf="currentConversation != null; then conversationBlock else attentionBlock"></section>
  </div>

  <section *ngIf="currentConversation != null; then messageBlock"></section>
</div>

<ng-template #conversationBlock>
  <div class="col-sm-9 w-100 min-vh-100 container-scroll overflow-auto border">
    <app-conversation-messages [conversation]="currentConversation"></app-conversation-messages>
  </div>
</ng-template>

<ng-template #attentionBlock>
  <div class="col-sm-9 d-flex align-items-center justify-content-center">
    <h6 class="alert alert-light box-shadow border bg-transparent rounded">Select a chat to start messaging</h6>
  </div>
</ng-template>

<ng-template #messageBlock>
  <div class="row">
    <div class="col-sm-12">
      <form class="float-right w-100" (ngSubmit)="onSendMessage()" [formGroup]="messageFormGroup" method="post">
        <div class="row">
          <div class="offset-sm-3"></div>
          <div class="col-sm-8">
            <div class="form-group">
              <label class="text-hide" for="conversation_message">Message</label>
              <textarea formControlName="message"
                        id="conversation_message"
                        placeholder="Enter message..."
                        required></textarea>

              <div *ngIf="message.invalid && (message.dirty || message.touched)" class="text-danger mt-1">
                <div *ngIf="message.errors?.required"><span>Message cannot be empty.</span></div>
              </div>
            </div>
          </div>
          <div class="col-sm-1">
            <button [disabled]="messageFormGroup.invalid" class="btn btn-primary p-3 mt-4" type="submit">
              Send
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
</ng-template>
